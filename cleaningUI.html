<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
  <h2>Custom Menu</h2>
  <form>
    <label for="optionSelect">Select an option:</label>
    <select id="optionSelect" name="optionSelect">
      <option value="companyName">Clean Company Name</option>
      <option value="firstName">Clean First Name</option>
    </select>
    <br>
    <label for="columnIndex">Enter the column number:</label>
    <input type="number" id="columnIndex" name="columnIndex">
    <br>
    <input type="button" value="Clean Data" onclick="executeCleanData()">
  </form>
  <script>
    function executeCleanData() {
      var selectedOption = document.getElementById('optionSelect').value;
      var columnIndex = document.getElementById('columnIndex').value;
      google.script.run.withSuccessHandler(closeSidebar).cleanData(selectedOption, Number(columnIndex));
    }

    function closeSidebar() {
      google.script.host.close();
    }
  </script>
</body>
</html>
